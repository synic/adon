This is the version I wrote for Arduino.  
